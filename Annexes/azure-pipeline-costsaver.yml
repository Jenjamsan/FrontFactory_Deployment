pool:
  name: Azure Pipelines
#Your build pipeline references a secret variable named ‘USER_PASSWORD’. Create or edit the build pipeline for this YAML file, define the variable on the Variables tab, and then select the option to make it secret. See https://go.microsoft.com/fwlink/?linkid=865972

steps:

- task: AzureCLI@2
  inputs:
    azureSubscription: 'Azure for Students (25fd2547-387b-4b6e-bdbc-e94b0a03af2a)'
    scriptType: 'ps'
    scriptLocation: 'inlineScript'
    inlineScript: 'az login -u $1 -p $2'
    arguments: '$(USER_LOGIN) $(USER_PASSWORD)'


- task: AzureVMStartStop@1
  inputs:
    VMList: 'aks-agentpool-54707845-vmss'
    ResourceGroupName: 'MC_frontfactory_aksff_australiacentral'
    Action: 'Stop'
    ConnectedServiceName: 'Azure for Students (25fd2547-387b-4b6e-bdbc-e94b0a03af2a)'


- task: DownloadCostData@1
  inputs:
    ConnectedServiceNameARM: 'Azure for Students (25fd2547-387b-4b6e-bdbc-e94b0a03af2a)'
    DaysToDownload: '60'
    apiToUse: 'usage'
    offerType: 'MS-AZR-0017G'
    currency: 'EUR'
    locale: 'fr-EU'
    regioInfo: 'FR'
    filter: 'no'

- task: PublishCostData@1